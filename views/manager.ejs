<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Manager</title>
    
    <link rel="stylesheet" href="manager.css">
    <script
      src="https://kit.fontawesome.com/21ef82ed30.js"
      crossorigin="anonymous"
    ></script>
</head>




<% 
let appetizerCount=0
let entreeCount=0
let dessertCount=0
for (let i=0; i<info.length; i++){
    if (info[i].category == "SPECIALS: Appetizer" && info[i].sequence != "0") appetizerCount++ 
    if (info[i].category == "SPECIALS: Entrée" && info[i].sequence != "0") entreeCount++ 
    if (info[i].category == "SPECIALS: Dessert" && info[i].sequence != "0") dessertCount++ 
}

%>
<script>
let appetizerCount = <%=appetizerCount%>
let entreeCount = <%=entreeCount%>
let dessertCount = <%=dessertCount%>
</script>





<body>
    <div id="wrapper">
    <div id="content">
    <nav>
        <h1>
                olea
                <span id="content-manager">Content Manager</span></h1>
                
                
                <ul>
                    <li class="active-page">Specials</li>
                    <li id="dinner">Dinner</li>
                    <li>Dessert</li>
                    <li>Wine/Drinks</li>
                    <li id="archive">Archive</li>
                </ul>
                <ul id="nav-ul-bottom">
                    <li class="active-page">Edit Menu Items</li>
                    <li id="specials-format-layout">Format Layout</li>
                    <li id="specials-print-preview">Print Preview</li>
                </ul>
    </nav>
    <main>        
            
           
        <% if(appetizerCount == "1"){ %>
            <h2>SPECIAL: Appetizer</h2>
        <%}%>
        <% if(appetizerCount > "1"){ %>
            <h2>SPECIALS: Appetizers</h2>
        <%}%>
        
        <ul class="specials-appetizers">
          <% for(let i=0; i<info.length;i++){ 
            if( info[i].sequence &&
                info[i].sequence != "" &&
                info[i].sequence != "0" && 
                info[i].category == "SPECIALS: Appetizer"){ %>
          <li class="special">
            <% if(info[i].sequence == "1"){ %>
                <div class="move-up" style="visibility:hidden"><i class="fa-solid fa-sort-up"></i></div>
            <% }else{ %>
                <div class="move-up"><i class="fa-solid fa-sort-up"></i></div>
            <% } %>
            <div><%= info[i]._id %></div>
            <div><%= info[i].category %></div>
            <div><%= info[i].sequence %></div>
            <div><%= info[i].name %></div>
            <div><%= info[i].description %></div>
            <div><%= info[i].price %></div>
            <div><%= info[i].allergies %></div>
            <div><%- `${info[i].timestamp}`.substring(0,24) %></div>
            <span class="edit"><i class="fa-solid fa-pencil"></i> Edit</span
                >&nbsp;&nbsp;
                <span class="archive"
                ><i class="fa-solid fa-box-archive"></i> Archive</span
                >&nbsp;&nbsp;
                <span class="del"><i class="fa-solid fa-trash-can"></i> Delete</span
                    >&nbsp;&nbsp;
                    <span class="transfer"
                    ><i class="fa-solid fa-arrow-right-arrow-left"></i> Transfer</span
                    >&nbsp;&nbsp;
            <% if(info[i].sequence != appetizerCount){ %>
                <div class="move-down"><i class="fa-solid fa-sort-down"></i></div>
            <% } %>
           </li>
          <% } } %>
        </ul>
    
    
    
        <% if(entreeCount == "1"){ %>
            <h2>SPECIAL: Entrée</h2>
        <%}%>
        <% if(entreeCount > "1"){ %>
            <h2>SPECIALS: Entrées</h2>
        <%}%>
        <ul class="specials-entrees">
          <% for(let i=0; i<info.length;i++){ 
            if( info[i].sequence &&
                info[i].sequence != "" && 
                info[i].sequence != "0" &&
                info[i].category == "SPECIALS: Entrée"){ %>
          <li class="special">
            <% if(info[i].sequence == "1"){ %>
                <div class="move-up" style="visibility:hidden"><i class="fa-solid fa-sort-up"></i></div>
            <% }else{ %>
                <div class="move-up"><i class="fa-solid fa-sort-up"></i></div>
            <% } %>
            <div><%= info[i]._id %></div>
            <div><%= info[i].category %></div>
            <div><%= info[i].sequence %></div>
            <div><%= info[i].name %></div>
            <div><%= info[i].description %></div>
            <div><%= info[i].price %></div>
            <div><%= info[i].allergies %></div>
            <div><%- `${info[i].timestamp}`.substring(0,24) %></div>
            <span class="edit"><i class="fa-solid fa-pencil"></i> Edit</span
            >&nbsp;&nbsp;
            <span class="archive"
              ><i class="fa-solid fa-box-archive"></i> Archive</span
            >&nbsp;&nbsp;
            <span class="del"><i class="fa-solid fa-trash-can"></i> Delete</span
            >&nbsp;&nbsp;
            <span class="transfer"
              ><i class="fa-solid fa-arrow-right-arrow-left"></i> Transfer</span
            >&nbsp;&nbsp;
            <% if(info[i].sequence != entreeCount){ %>
                <div class="move-down"><i class="fa-solid fa-sort-down"></i></div>
            <% } %>
    
          </li>
          <% } } %>
        </ul>
    
        <% if(dessertCount == "1"){ %>
            <h2>SPECIAL: Dessert</h2>
        <%}%>
        <% if(dessertCount > "1"){ %>
            <h2>SPECIALS: Desserts</h2>
        <%}%>
        <ul class="specials-desserts">
          <% for(let i=0; i<info.length;i++){ 
            if( info[i].sequence &&
                info[i].sequence != "" && 
                info[i].sequence != "0" &&
                info[i].category == "SPECIALS: Dessert"){ %>
          <li class="special">
            <% if(info[i].sequence == "1"){ %>
                <div class="move-up" style="visibility:hidden"><i class="fa-solid fa-sort-up"></i></div>
            <% }else{ %>
                <div class="move-up"><i class="fa-solid fa-sort-up"></i></div>
            <% } %>
     
            <div><%= info[i]._id %></div>
            <div><%= info[i].category %></div>
            <div><%= info[i].sequence %></div>
            <div><%= info[i].name %></div>
            <div><%= info[i].description %></div>
            <div><%= info[i].price %></div>
            <div><%= info[i].allergies %></div>
            <div><%- `${info[i].timestamp}`.substring(0,24) %></div>
            <span class="edit"><i class="fa-solid fa-pencil"></i> Edit</span
            >&nbsp;&nbsp;
            <span class="archive"
              ><i class="fa-solid fa-box-archive"></i> Archive</span
            >&nbsp;&nbsp;
            <span class="del"><i class="fa-solid fa-trash-can"></i> Delete</span
            >&nbsp;&nbsp;
            <span class="transfer"
              ><i class="fa-solid fa-arrow-right-arrow-left"></i> Transfer</span
            >&nbsp;&nbsp;
            <% if(info[i].sequence != dessertCount){ %>
                <div class="move-down"><i class="fa-solid fa-sort-down"></i></div>
            <% } %>
    
          </li>
          <% } } %>
        </ul>
    
        <h2>Add New Menu Item:</h2>
    
        <form action="/addSpecial" method="POST">
          <input type="text" placeholder="Category" name="category" /><br />
          <input type="text" placeholder="Sequence" name="sequence" /><br />
          <input type="text" placeholder="Name" name="name" /><br />
          <textarea
            rows="5"
            cols="40"
            placeholder="Description"
            name="description"
          ></textarea
          ><br />
          <input type="text" placeholder="Price" name="price" /><br />
          <input type="text" placeholder="Allergies" name="allergies" /><br />
          <!-- <input type="hidden" name="timestamp" id="timestamp-add-special">
          <script>
            document.querySelector('#timestamp-add-special').value = new Date()
          </script> -->
          <input type="submit" id="update-button" value="Create" />
        </form>
    
        <h2>Edit Exisiting Menu Item:</h2>
    
        <form action="/editSpecial" method="POST">
          <div name="_id" id="display-ID"></div>
          <input type="text" id="edit-id" placeholder="ID#" name="_id" /><br />
          <input
            type="text"
            id="edit-category"
            placeholder="Category"
            name="category"
          /><br />
          <input
            type="text"
            id="edit-sequence"
            placeholder="Sequence"
            name="sequence"
          /><br />
          <input type="text" id="edit-name" placeholder="Name" name="name" /><br />
          <textarea
            rows="5"
            cols="40"
            placeholder="Description"
            id="edit-description"
            name="description"
          ></textarea
          ><br />
          <input
            type="text"
            id="edit-price"
            placeholder="Price"
            name="price"
          /><br />
          <input
            type="text"
            id="edit-allergies"
            placeholder="Allergies"
            name="allergies"
          /><br />
    
          <!-- <input type="hidden" name="timestamp" id="timestamp-edit-special">
          <script>
            document.querySelector('#timestamp-edit-special').value = new Date()
          </script> -->
    
          <input type="submit" value="Update" />
        </form>

        <footer>
            <ul>
                <li>Specials</li>
                <li>Dinner</li>
                <li>Dessert</li>
                <li>Wine/Drinks</li>
                <li>Archive</li>
            </ul>
        </footer>
    </main>
    </div><!--#content-->
    </div><!--#wrapper-->
    
        <script src="main.js"></script>
        <script>
          document.querySelector('#specials-format-layout').addEventListener('click',()=>{
            location.replace('/specialsFormatLayout')
          })    
          document.querySelector('#specials-print-preview').addEventListener('click',()=>{
                location.replace('/specialsPrintPreview')
            })
            document.querySelector('#archive').addEventListener('click',()=>{
                location.replace('/archive')
            })
            document.querySelector('#dinner').addEventListener('click',()=>{
                location.replace('/dinnerUpdateCuredMeats')
            })

        </script>
</body>
</html>